package bearlyb.pixels

import org.lwjgl.sdl.SDLPixels.*
import org.lwjgl.sdl.SDL_Palette

opaque type PixelFormat = Int

object PixelFormat:
  val Unknown: PixelFormat = 0
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_INDEX1, SDL_BITMAPORDER_4321, 0, 1,
   * 0), */
  val Index1LSB: PixelFormat = 0x11100100
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_INDEX1, SDL_BITMAPORDER_1234, 0, 1,
   * 0), */
  val Index1MSB: PixelFormat = 0x11200100
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_INDEX2, SDL_BITMAPORDER_4321, 0, 2,
   * 0), */
  val Index2LSB: PixelFormat = 0x1c100200
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_INDEX2, SDL_BITMAPORDER_1234, 0, 2,
   * 0), */
  val Index2MSB: PixelFormat = 0x1c200200
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_INDEX4, SDL_BITMAPORDER_4321, 0, 4,
   * 0), */
  val Index4LSB: PixelFormat = 0x12100400
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_INDEX4, SDL_BITMAPORDER_1234, 0, 4,
   * 0), */
  val Index4MSB: PixelFormat = 0x12200400
  // SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_INDEX8, 0, 0, 8, 1),
  val Index8: PixelFormat = 0x13000801
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED8, SDL_PACKEDORDER_XRGB,
   * SDL_PACKEDLAYOUT_332, 8, 1), */
  val RGB332: PixelFormat = 0x14110801
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_XRGB,
   * SDL_PACKEDLAYOUT_4444, 12, 2), */
  val XRGB4444: PixelFormat = 0x15120c02
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_XBGR,
   * SDL_PACKEDLAYOUT_4444, 12, 2), */
  val XBGR4444: PixelFormat = 0x15520c02
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_XRGB,
   * SDL_PACKEDLAYOUT_1555, 15, 2), */
  val XRGB1555: PixelFormat = 0x15130f02
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_XBGR,
   * SDL_PACKEDLAYOUT_1555, 15, 2), */
  val XBGR1555: PixelFormat = 0x15530f02
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_ARGB,
   * SDL_PACKEDLAYOUT_4444, 16, 2), */
  val ARGB4444: PixelFormat = 0x15321002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_RGBA,
   * SDL_PACKEDLAYOUT_4444, 16, 2), */
  val RGBA4444: PixelFormat = 0x15421002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_ABGR,
   * SDL_PACKEDLAYOUT_4444, 16, 2), */
  val ABGR4444: PixelFormat = 0x15721002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_BGRA,
   * SDL_PACKEDLAYOUT_4444, 16, 2), */
  val BGRA4444: PixelFormat = 0x15821002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_ARGB,
   * SDL_PACKEDLAYOUT_1555, 16, 2), */
  val ARGB1555: PixelFormat = 0x15331002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_RGBA,
   * SDL_PACKEDLAYOUT_5551, 16, 2), */
  val RGBA5551: PixelFormat = 0x15441002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_ABGR,
   * SDL_PACKEDLAYOUT_1555, 16, 2), */
  val ABGR1555: PixelFormat = 0x15731002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_BGRA,
   * SDL_PACKEDLAYOUT_5551, 16, 2), */
  val BGRA5551: PixelFormat = 0x15841002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_XRGB,
   * SDL_PACKEDLAYOUT_565, 16, 2), */
  val RGB565: PixelFormat = 0x15151002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED16, SDL_PACKEDORDER_XBGR,
   * SDL_PACKEDLAYOUT_565, 16, 2), */
  val BGR565: PixelFormat = 0x15551002
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU8, SDL_ARRAYORDER_RGB, 0, 24,
   * 3), */
  val RGB24: PixelFormat = 0x17101803
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU8, SDL_ARRAYORDER_BGR, 0, 24,
   * 3), */
  val BGR24: PixelFormat = 0x17401803
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_XRGB,
   * SDL_PACKEDLAYOUT_8888, 24, 4), */
  val XRGB8888: PixelFormat = 0x16161804
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_RGBX,
   * SDL_PACKEDLAYOUT_8888, 24, 4), */
  val RGBX8888: PixelFormat = 0x16261804
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_XBGR,
   * SDL_PACKEDLAYOUT_8888, 24, 4), */
  val XBGR8888: PixelFormat = 0x16561804
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_BGRX,
   * SDL_PACKEDLAYOUT_8888, 24, 4), */
  val BGRX8888: PixelFormat = 0x16661804
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_ARGB,
   * SDL_PACKEDLAYOUT_8888, 32, 4), */
  val ARGB8888: PixelFormat = 0x16362004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_RGBA,
   * SDL_PACKEDLAYOUT_8888, 32, 4), */
  val RGBA8888: PixelFormat = 0x16462004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_ABGR,
   * SDL_PACKEDLAYOUT_8888, 32, 4), */
  val ABGR8888: PixelFormat = 0x16762004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_BGRA,
   * SDL_PACKEDLAYOUT_8888, 32, 4), */
  val BGRA8888: PixelFormat = 0x16862004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_XRGB,
   * SDL_PACKEDLAYOUT_2101010, 32, 4), */
  val XRGB2101010: PixelFormat = 0x16172004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_XBGR,
   * SDL_PACKEDLAYOUT_2101010, 32, 4), */
  val XBGR2101010: PixelFormat = 0x16572004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_ARGB,
   * SDL_PACKEDLAYOUT_2101010, 32, 4), */
  val ARGB2101010: PixelFormat = 0x16372004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_PACKED32, SDL_PACKEDORDER_ABGR,
   * SDL_PACKEDLAYOUT_2101010, 32, 4), */
  val ABGR2101010: PixelFormat = 0x16772004
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU16, SDL_ARRAYORDER_RGB, 0, 48,
   * 6), */
  val RGB48: PixelFormat = 0x18103006
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU16, SDL_ARRAYORDER_BGR, 0, 48,
   * 6), */
  val BGR48: PixelFormat = 0x18403006
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU16, SDL_ARRAYORDER_RGBA, 0, 64,
   * 8), */
  val RGBA64: PixelFormat = 0x18204008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU16, SDL_ARRAYORDER_ARGB, 0, 64,
   * 8), */
  val ARGB64: PixelFormat = 0x18304008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU16, SDL_ARRAYORDER_BGRA, 0, 64,
   * 8), */
  val BGRA64: PixelFormat = 0x18504008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYU16, SDL_ARRAYORDER_ABGR, 0, 64,
   * 8), */
  val ABGR64: PixelFormat = 0x18604008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF16, SDL_ARRAYORDER_RGB, 0, 48,
   * 6), */
  val RGB48Float: PixelFormat = 0x1a103006
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF16, SDL_ARRAYORDER_BGR, 0, 48,
   * 6), */
  val BGR48Float: PixelFormat = 0x1a403006
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF16, SDL_ARRAYORDER_RGBA, 0, 64,
   * 8), */
  val RGBA64Float: PixelFormat = 0x1a204008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF16, SDL_ARRAYORDER_ARGB, 0, 64,
   * 8), */
  val ARGB64Float: PixelFormat = 0x1a304008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF16, SDL_ARRAYORDER_BGRA, 0, 64,
   * 8), */
  val BGRA64Float: PixelFormat = 0x1a504008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF16, SDL_ARRAYORDER_ABGR, 0, 64,
   * 8), */
  val ABGR64Float: PixelFormat = 0x1a604008
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF32, SDL_ARRAYORDER_RGB, 0, 96,
   * 12), */
  val RGB96Float: PixelFormat = 0x1b10600c
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF32, SDL_ARRAYORDER_BGR, 0, 96,
   * 12), */
  val BGR96Float: PixelFormat = 0x1b40600c
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF32, SDL_ARRAYORDER_RGBA, 0, 128,
   * 16), */
  val RGBA128Float: PixelFormat = 0x1b208010
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF32, SDL_ARRAYORDER_ARGB, 0, 128,
   * 16), */
  val ARGB128Float: PixelFormat = 0x1b308010
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF32, SDL_ARRAYORDER_BGRA, 0, 128,
   * 16), */
  val BGRA128Float: PixelFormat = 0x1b508010
  /* SDL_DEFINE_PIXELFORMAT(SDL_PIXELTYPE_ARRAYF32, SDL_ARRAYORDER_ABGR, 0, 128,
   * 16), */

  val ABGR128Float: PixelFormat = 0x1b608010
  // SDL_DEFINE_PIXELFOURCC('Y', 'V', '1', '2'),
  /** Planar mode: Y + V + U  (3 planes) */
  val YV12: PixelFormat = 0x32315659
  // SDL_DEFINE_PIXELFOURCC('I', 'Y', 'U', 'V'),
  /** Planar mode: Y + U + V  (3 planes) */
  val IYUV: PixelFormat = 0x56555949
  // SDL_DEFINE_PIXELFOURCC('Y', 'U', 'Y', '2'),
  /** Packed mode: Y0+U0+Y1+V0 (1 plane) */
  val YUY2: PixelFormat = 0x32595559
  // SDL_DEFINE_PIXELFOURCC('U', 'Y', 'V', 'Y'),
  /** Packed mode: U0+Y0+V0+Y1 (1 plane) */
  val UYVY: PixelFormat = 0x59565955
  // SDL_DEFINE_PIXELFOURCC('Y', 'V', 'Y', 'U'),
  /** Packed mode: Y0+V0+Y1+U0 (1 plane) */
  val YVYU: PixelFormat = 0x55595659
  // SDL_DEFINE_PIXELFOURCC('N', 'V', '1', '2'),
  /** Planar mode: Y + U/V interleaved  (2 planes) */
  val NV12: PixelFormat = 0x3231564e
  // SDL_DEFINE_PIXELFOURCC('N', 'V', '2', '1'),
  /** Planar mode: Y + V/U interleaved  (2 planes) */
  val NV21: PixelFormat = 0x3132564e
  // SDL_DEFINE_PIXELFOURCC('P', '0', '1', '0'),
  /** Planar mode: Y + U/V interleaved  (2 planes) */
  val P010: PixelFormat = 0x30313050
  // SDL_DEFINE_PIXELFOURCC('O', 'E', 'S', ' ')
  /** Android video texture format */
  val ExternalOES: PixelFormat = 0x2053454f

  // SDL_DEFINE_PIXELFOURCC('M', 'J', 'P', 'G')
  /** Motion JPEG */
  val MJPG: PixelFormat = 0x47504a4d

  val RGBA32: PixelFormat = SDL_PIXELFORMAT_RGBA32
  val ARGB32: PixelFormat = SDL_PIXELFORMAT_ARGB32
  val BGRA32: PixelFormat = SDL_PIXELFORMAT_BGRA32
  val ABGR32: PixelFormat = SDL_PIXELFORMAT_ABGR32
  val RGBX32: PixelFormat = SDL_PIXELFORMAT_RGBX32
  val XRGB32: PixelFormat = SDL_PIXELFORMAT_XRGB32
  val BGRX32: PixelFormat = SDL_PIXELFORMAT_BGRX32
  val XBGR32: PixelFormat = SDL_PIXELFORMAT_XBGR32

  extension (p: PixelFormat)
    private[bearlyb] def internal: Int = p

    def mapColor(c: Color, palette: Palette | Null = null): RawColor =
      import bearlyb.vectors.Vec.given
      val (r, g, b, a)             = c.toTuple.vmap(_.toByte)
      val ipal: SDL_Palette | Null = palette match
        case null         => null
        case pal: Palette => pal.internal
      RawColor(SDL_MapRGBA(SDL_GetPixelFormatDetails(p), ipal, r, g, b, a))

  end extension

  private[bearlyb] def fromInternal(internal: Int): PixelFormat = internal

end PixelFormat
